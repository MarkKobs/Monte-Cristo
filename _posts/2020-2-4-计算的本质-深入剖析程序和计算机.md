---
title: 计算的本质-深入剖析程序与计算机
date: 2020-02-04 11:41:00 
tags: ruby
category: 形式化
---

计算的本质-深入剖析程序与计算机是一本可以反复读的好书，一些学习的记录作于此，以便温故知新。

## ruby上手

先以一个例子熟悉ruby的对象和方法

**1、对象，方法，消息**

```ruby
o=Object.new
def o.add(x,y)
  x+y
end
o.add(2,3)
```

> 创建对象

> 定义方法：包括接收对象o，名字add和参数x、y

> 对象.消息名(方法名)（参数1，参数2）



**2、对象追踪**

```ruby
def o.add_twice(x,y)
  add(x,y)+add(x,y)
end
o.add(2,3)
```

Ruby默认追踪当前对象(self)，在方法定义内部，可不必显示提及接收对象。



**3、默认main的特殊顶层对象**

```ruby
def multiply(a,b)
  a*b
end
multiply(2,3)
```

在没有指明接收对象时，默认为main的特殊顶层对象。



**4、类定义与类继承**

```ruby
class Calculator
  def add(x,y)
    x+Y
  end
end
```

```ruby
class MultiplyingCalculator < Calculator
  def multiply(x,y)
    x*y
  end
end
```



**5、模块**

```ruby
module Addition
  把方法定义在这
end

class NewClass
  include Addtion
end
```



**6、字符串插值**

对于双引号中的字符串，ruby会自动将表达式的结果替换#{表达式}

```ruby
>>"hello #{'dlrow'.reverse}"
=>"hello world"
```

```ruby
>>"#{2+3}"
=>"5"
```

假如被插入的表达式返回的不是一个字符串类型的对象，那么这个对象就会自动调用一个to_s消息以返回能顶替其位置的字符串。

```ruby
>>o=Object.new
>>def o.to_s
  'a new object'
end
>> "here is #{0}"
```



**7、inspect**

通常这个函数和to_s一样，直接调用to_s，但是它的功能不同，通常用于在IRB中检查一个对象的状态，还可以包含其他信息。

```ruby
>>o=Object.new
>>def o.inspect
  '[my object]'
end
>>o
```



**8、可变参数方法**

```ruby
def join_with_commas(*words)
  words.join(',')
end

>>join_with_commas('one','two','three')
```

一个方法只能有一个可变参数，而常规参数可以放到可变参数的前后：

```ruby
>>def join_with_commas(before,*words,after)
  before+words.join(',')+after
end
>>join_with_commas("Testing:",1,2,3,'.')
```

